<!DOCTYPE html>
<!-- saved from url=(0037)https://eggctw.com/index/index/answer -->
<html lang="en" class="wf-active"><!--  4573884696a2 | twig:1.41.0-DEV | cluster: cheggstudy | fullConf: prod-cheggstudy --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="format-detection" content="telephone=no">


    <title>2. Consider A Twice Repeated Game With The Followi... | Chegg.com</title>

    <meta name="viewport" content="width=1024">









    <link rel="stylesheet" type="text/css" href="./2. Consider A Twice Repeated Game With The Followi... _ Chegg.com_files/74bd73826966ac2a6bc8d0c322435ca1.css" media="all" data-scope="global">
    <link rel="stylesheet" type="text/css" href="./2. Consider A Twice Repeated Game With The Followi... _ Chegg.com_files/405663af85d4d76d385ab9c1eb205983.css" media="all" data-scope="content">
    <!--[if lt IE 9]>
    <link rel="stylesheet" href="https://c.cheggcdn.com/s/_css/_global/ie.css" />
    <![endif]-->


    <style>
        .question-toolbar{
            display: none;
        }
        .question-text h1{
            color: #eb7100;
            font-size: 24px;
            font-family: "Aspira","Helvetica","Arial",Sans-serif;
        }
    </style>


</head>
<body class="desktop dedicated-nav oc-nav chegg-css vsc-initialized">
<div class="chg-body no-nav no-subnav  header-nav ">
    <div class="chg-root"></div>
    <div id="fb-root"></div>



    <div class="chg-container center-content   ">
        <div class="chg-container-tower"></div>
        <div class="chg-container-content">


            <div class="chg-global-content">
                <div class="chg-content HomeworkhelpQuestion" aria-label="Chegg Content" role="main">

                    <div class="parent-container question-headline">
                        <div class="main-content question-page ">








                            <div id="study-notification"></div>




                            <div itemscope="" itemtype="https://schema.org/CreativeWork" data-qid="65707683" class="dialog-question">
                                <div class="question txt-small" data-commentingid="65707683">
                                    

                                </div>
                                <div class="answers-h2">
                                    <h2 itemprop="learningResourceType">答案</h2>


                                </div>
                                <div class="answers-wrap"><ul class="answers-list">
                                    <li data-answerid="64993554">

                                        <div class=" answer txt-small mod-parent-container" data-commentingid="64993554">


                                            <div class="txt-body answer-body">
                                                <div class="answer-given-body ugc-base">
                                                    <style data-styled="true" data-styled-version="5.3.6">.jOOFPV{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/*!sc*/
data-styled.g713[id="sc-z3f5s1-0"]{content:"jOOFPV,"}/*!sc*/
.drpmfd{white-space:pre-wrap;}/*!sc*/
data-styled.g715[id="sc-1aslxm9-0"]{content:"drpmfd,"}/*!sc*/
.csrprK{text-align:start;}/*!sc*/
data-styled.g717[id="sc-1aslxm9-2"]{content:"csrprK,"}/*!sc*/
.hSgzqy{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g744[id="sc-9wsboo-0"]{content:"hSgzqy,"}/*!sc*/
.fjTYVF{margin:0;font-size:1rem;}/*!sc*/
data-styled.g746[id="sc-1swtczx-0"]{content:"fjTYVF,"}/*!sc*/
.fiTshW{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;font-size:0.75rem;box-sizing:border-box;}/*!sc*/
data-styled.g766[id="sc-2n8uaj-0"]{content:"fiTshW,"}/*!sc*/
.cEHddw{position:relative;}/*!sc*/
data-styled.g767[id="sc-2n8uaj-1"]{content:"cEHddw,"}/*!sc*/
.eWUOMm::before{position:absolute;content:attr(data-line);color:rgba(60,60,60,0.5);top:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}/*!sc*/
data-styled.g768[id="sc-2n8uaj-2"]{content:"eWUOMm,"}/*!sc*/
.dNhINZ{margin-left:2em;}/*!sc*/
data-styled.g769[id="sc-2n8uaj-3"]{content:"dNhINZ,"}/*!sc*/
.kqpsvw{background-color:#f7f7f7;}/*!sc*/
.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
.kqpsvw pre[class*='language-']::selection,.kqpsvw pre[class*='language-']::selection,.kqpsvw code[class*='language-']::selection,.kqpsvw code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
@media print{.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{text-shadow:none;}}/*!sc*/
.kqpsvw pre[class*='language-']{padding:1em;margin:0.5em 0;overflow:auto;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-'],.kqpsvw pre[class*='language-']{background:#f5f2f0;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-']{padding:0.1em;border-radius:0.3em;white-space:normal;}/*!sc*/
.kqpsvw div,.kqpsvw span,.kqpsvw .token{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
.kqpsvw .token.comment,.kqpsvw .token.prolog,.kqpsvw .token.doctype,.kqpsvw .token.cdata{color:slategray;}/*!sc*/
.kqpsvw .token.punctuation{color:#999;}/*!sc*/
.kqpsvw .token.namespace{opacity:0.7;}/*!sc*/
.kqpsvw .token.property,.kqpsvw .token.tag,.kqpsvw .token.boolean,.kqpsvw .token.number,.kqpsvw .token.constant,.kqpsvw .token.symbol,.kqpsvw .token.deleted{color:#905;}/*!sc*/
.kqpsvw .token.selector,.kqpsvw .token.attr-name,.kqpsvw .token.string,.kqpsvw .token.char,.kqpsvw .token.builtin,.kqpsvw .token.inserted{color:#690;}/*!sc*/
.kqpsvw .token.operator,.kqpsvw .token.entity,.kqpsvw .token.url,.kqpsvw .language-css .token.string,.kqpsvw .style .token.string{color:#9a6e3a;}/*!sc*/
.kqpsvw .token.atrule,.kqpsvw .token.attr-value,.kqpsvw .token.keyword{color:#07a;}/*!sc*/
.kqpsvw .token.function,.kqpsvw .token.class-name{color:#dd4a68;}/*!sc*/
.kqpsvw .token.regex,.kqpsvw .token.important,.kqpsvw .token.variable{color:#e90;}/*!sc*/
.kqpsvw .token.important,.kqpsvw .token.bold{font-weight:bold;}/*!sc*/
.kqpsvw .token.italic{font-style:italic;}/*!sc*/
.kqpsvw .token.entity{cursor:help;}/*!sc*/
data-styled.g770[id="sc-2n8uaj-4"]{content:"kqpsvw,"}/*!sc*/
.gyWqNe{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;padding:0 1.5rem;}/*!sc*/
data-styled.g778[id="sc-1tx9li6-0"]{content:"gyWqNe,"}/*!sc*/
.hQuWQW{font-size:0.75rem;margin-bottom:0.5rem;text-transform:uppercase;}/*!sc*/
data-styled.g779[id="sc-1tx9li6-1"]{content:"hQuWQW,"}/*!sc*/
.dhvtXR{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;line-height:normal;}/*!sc*/
data-styled.g781[id="sc-1sugbjn-0"]{content:"dhvtXR,"}/*!sc*/
</style><div class="sc-1sugbjn-1 jnaMkA"><div class="sc-1sugbjn-2 hMQlEz"><h3 id="step-1-of-5" class="sc-1sugbjn-3 iylRCG"></h3><div><div class="sc-z3f5s1-0 jOOFPV" data-test="blocks"><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-0"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">The problem asks us to decode a noisy string generated according to a probabilistic model. We need to find the most likely clean sequence and count the occurrences of (firstname, surname) pairs along the way.</div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1tx9li6-0 gyWqNe" data-test="block-1"><div class="sc-1tx9li6-1 hQuWQW">Explanation</div><div class="sc-1swtczx-0 fjTYVF" data-test="block-1-text-block"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">To decode the noisy string, we use the Viterbi algorithm. This is a dynamic programming algorithm that allows us to efficiently compute the most likely sequence of hidden states (i.e., the sequence of firstnames, surnames, and non-name characters) that generated the observed sequence of characters. We represent the state of the system at time <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i</code></strong> by a number between 0 and 11, where 0 to 4 represent the firstnames, 5 represents the transition between firstnames and surnames, and 6 to 11 represent the surnames.</div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-2"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><strong class="sc-1r1de4b-0 gHXJCW">First, we need to load the data from the "noisystring.mat" file:</strong></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">import</span> scipy<span class="token punctuation">.</span>io</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="5" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">data <span class="token operator">=</span> scipy<span class="token punctuation">.</span>io<span class="token punctuation">.</span>loadmat<span class="token punctuation">(</span><span class="token string">'noisystring.mat'</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="6" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">noisy_string <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'noisystring'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="7" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-4"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div></div>- - - - - - - - - - - - - - - - - - - - - - - - <style data-styled="true" data-styled-version="5.3.6">.jOOFPV{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/*!sc*/
data-styled.g713[id="sc-z3f5s1-0"]{content:"jOOFPV,"}/*!sc*/
.drpmfd{white-space:pre-wrap;}/*!sc*/
data-styled.g715[id="sc-1aslxm9-0"]{content:"drpmfd,"}/*!sc*/
.csrprK{text-align:start;}/*!sc*/
data-styled.g717[id="sc-1aslxm9-2"]{content:"csrprK,"}/*!sc*/
.hSgzqy{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g744[id="sc-9wsboo-0"]{content:"hSgzqy,"}/*!sc*/
.fjTYVF{margin:0;font-size:1rem;}/*!sc*/
data-styled.g746[id="sc-1swtczx-0"]{content:"fjTYVF,"}/*!sc*/
.fiTshW{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;font-size:0.75rem;box-sizing:border-box;}/*!sc*/
data-styled.g766[id="sc-2n8uaj-0"]{content:"fiTshW,"}/*!sc*/
.cEHddw{position:relative;}/*!sc*/
data-styled.g767[id="sc-2n8uaj-1"]{content:"cEHddw,"}/*!sc*/
.eWUOMm::before{position:absolute;content:attr(data-line);color:rgba(60,60,60,0.5);top:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}/*!sc*/
data-styled.g768[id="sc-2n8uaj-2"]{content:"eWUOMm,"}/*!sc*/
.dNhINZ{margin-left:2em;}/*!sc*/
data-styled.g769[id="sc-2n8uaj-3"]{content:"dNhINZ,"}/*!sc*/
.kqpsvw{background-color:#f7f7f7;}/*!sc*/
.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
.kqpsvw pre[class*='language-']::selection,.kqpsvw pre[class*='language-']::selection,.kqpsvw code[class*='language-']::selection,.kqpsvw code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
@media print{.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{text-shadow:none;}}/*!sc*/
.kqpsvw pre[class*='language-']{padding:1em;margin:0.5em 0;overflow:auto;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-'],.kqpsvw pre[class*='language-']{background:#f5f2f0;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-']{padding:0.1em;border-radius:0.3em;white-space:normal;}/*!sc*/
.kqpsvw div,.kqpsvw span,.kqpsvw .token{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
.kqpsvw .token.comment,.kqpsvw .token.prolog,.kqpsvw .token.doctype,.kqpsvw .token.cdata{color:slategray;}/*!sc*/
.kqpsvw .token.punctuation{color:#999;}/*!sc*/
.kqpsvw .token.namespace{opacity:0.7;}/*!sc*/
.kqpsvw .token.property,.kqpsvw .token.tag,.kqpsvw .token.boolean,.kqpsvw .token.number,.kqpsvw .token.constant,.kqpsvw .token.symbol,.kqpsvw .token.deleted{color:#905;}/*!sc*/
.kqpsvw .token.selector,.kqpsvw .token.attr-name,.kqpsvw .token.string,.kqpsvw .token.char,.kqpsvw .token.builtin,.kqpsvw .token.inserted{color:#690;}/*!sc*/
.kqpsvw .token.operator,.kqpsvw .token.entity,.kqpsvw .token.url,.kqpsvw .language-css .token.string,.kqpsvw .style .token.string{color:#9a6e3a;}/*!sc*/
.kqpsvw .token.atrule,.kqpsvw .token.attr-value,.kqpsvw .token.keyword{color:#07a;}/*!sc*/
.kqpsvw .token.function,.kqpsvw .token.class-name{color:#dd4a68;}/*!sc*/
.kqpsvw .token.regex,.kqpsvw .token.important,.kqpsvw .token.variable{color:#e90;}/*!sc*/
.kqpsvw .token.important,.kqpsvw .token.bold{font-weight:bold;}/*!sc*/
.kqpsvw .token.italic{font-style:italic;}/*!sc*/
.kqpsvw .token.entity{cursor:help;}/*!sc*/
data-styled.g770[id="sc-2n8uaj-4"]{content:"kqpsvw,"}/*!sc*/
.gyWqNe{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;padding:0 1.5rem;}/*!sc*/
data-styled.g778[id="sc-1tx9li6-0"]{content:"gyWqNe,"}/*!sc*/
.hQuWQW{font-size:0.75rem;margin-bottom:0.5rem;text-transform:uppercase;}/*!sc*/
data-styled.g779[id="sc-1tx9li6-1"]{content:"hQuWQW,"}/*!sc*/
.dhvtXR{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;line-height:normal;}/*!sc*/
data-styled.g781[id="sc-1sugbjn-0"]{content:"dhvtXR,"}/*!sc*/
</style><div class="sc-1sugbjn-1 jnaMkA"><div class="sc-1sugbjn-2 hMQlEz"><h3 id="step-2-of-5" class="sc-1sugbjn-3 iylRCG"></h3><div><div class="sc-z3f5s1-0 jOOFPV" data-test="blocks"><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-0"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">Next, we define the initial state probabilities (the probability of starting in a particular hidden state) as a uniform distribution over characters:</div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">initial_probs <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">initial_probs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">26</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-2"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">Now, we can use the Viterbi algorithm to find the most likely sequence of hidden states (i.e., the intended clean sequence). We keep track of the backpointers to reconstruct the most likely path.</div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>noisy_string<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">scores <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">backpointers <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="5" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="6" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="7" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="8" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        scores<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>initial_probs<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="9" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    <span class="token keyword">else</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="10" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="11" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">            char_idx <span class="token operator">=</span> characters<span class="token punctuation">.</span>index<span class="token punctuation">(</span>noisy_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="12" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">            char_score <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>char_probs<span class="token punctuation">[</span>j<span class="token punctuation">,</span> char_idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="13" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">            <span class="token keyword">if</span> j <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="14" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                name_score <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>name_probs<span class="token punctuation">[</span>j<span class="token punctuation">,</span> char_idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="15" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_scores <span class="token operator">=</span> scores<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> name_score</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="16" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_bp <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prev_scores<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="17" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                scores<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> char_score <span class="token operator">+</span> prev_scores<span class="token punctuation">[</span>prev_bp<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="18" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                backpointers<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> prev_bp</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="19" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">            <span class="token keyword">elif</span> j <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="20" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                name_score <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>name_probs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> char_idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="21" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_scores <span class="token operator">=</span> scores<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> name_score</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="22" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_bp <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prev_scores<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="23" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                scores<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> char_score <span class="token operator">+</span> prev_scores<span class="token punctuation">[</span>prev_bp<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="24" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                backpointers<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> prev_bp</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="25" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_surname_idx <span class="token operator">=</span> prev_bp <span class="token operator">+</span> <span class="token number">1</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="26" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">            <span class="token keyword">else</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="27" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                surname_score <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>name_probs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> char_idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="28" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_scores <span class="token operator">=</span> scores<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> surname_score</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="29" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                prev_bp <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>prev_scores<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="30" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                scores<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> char_score <span class="token operator">+</span> prev_scores<span class="token punctuation">[</span>prev_bp<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="31" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">                backpointers<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> prev_bp</div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="32" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="33" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-4"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div></div>- - - - - - - - - - - - - - - - - - - - - - - - <style data-styled="true" data-styled-version="5.3.6">.jOOFPV{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/*!sc*/
data-styled.g713[id="sc-z3f5s1-0"]{content:"jOOFPV,"}/*!sc*/
.drpmfd{white-space:pre-wrap;}/*!sc*/
data-styled.g715[id="sc-1aslxm9-0"]{content:"drpmfd,"}/*!sc*/
.csrprK{text-align:start;}/*!sc*/
data-styled.g717[id="sc-1aslxm9-2"]{content:"csrprK,"}/*!sc*/
.hSgzqy{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g744[id="sc-9wsboo-0"]{content:"hSgzqy,"}/*!sc*/
.fjTYVF{margin:0;font-size:1rem;}/*!sc*/
data-styled.g746[id="sc-1swtczx-0"]{content:"fjTYVF,"}/*!sc*/
.fiTshW{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;font-size:0.75rem;box-sizing:border-box;}/*!sc*/
data-styled.g766[id="sc-2n8uaj-0"]{content:"fiTshW,"}/*!sc*/
.cEHddw{position:relative;}/*!sc*/
data-styled.g767[id="sc-2n8uaj-1"]{content:"cEHddw,"}/*!sc*/
.eWUOMm::before{position:absolute;content:attr(data-line);color:rgba(60,60,60,0.5);top:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}/*!sc*/
data-styled.g768[id="sc-2n8uaj-2"]{content:"eWUOMm,"}/*!sc*/
.dNhINZ{margin-left:2em;}/*!sc*/
data-styled.g769[id="sc-2n8uaj-3"]{content:"dNhINZ,"}/*!sc*/
.kqpsvw{background-color:#f7f7f7;}/*!sc*/
.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
.kqpsvw pre[class*='language-']::selection,.kqpsvw pre[class*='language-']::selection,.kqpsvw code[class*='language-']::selection,.kqpsvw code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
@media print{.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{text-shadow:none;}}/*!sc*/
.kqpsvw pre[class*='language-']{padding:1em;margin:0.5em 0;overflow:auto;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-'],.kqpsvw pre[class*='language-']{background:#f5f2f0;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-']{padding:0.1em;border-radius:0.3em;white-space:normal;}/*!sc*/
.kqpsvw div,.kqpsvw span,.kqpsvw .token{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
.kqpsvw .token.comment,.kqpsvw .token.prolog,.kqpsvw .token.doctype,.kqpsvw .token.cdata{color:slategray;}/*!sc*/
.kqpsvw .token.punctuation{color:#999;}/*!sc*/
.kqpsvw .token.namespace{opacity:0.7;}/*!sc*/
.kqpsvw .token.property,.kqpsvw .token.tag,.kqpsvw .token.boolean,.kqpsvw .token.number,.kqpsvw .token.constant,.kqpsvw .token.symbol,.kqpsvw .token.deleted{color:#905;}/*!sc*/
.kqpsvw .token.selector,.kqpsvw .token.attr-name,.kqpsvw .token.string,.kqpsvw .token.char,.kqpsvw .token.builtin,.kqpsvw .token.inserted{color:#690;}/*!sc*/
.kqpsvw .token.operator,.kqpsvw .token.entity,.kqpsvw .token.url,.kqpsvw .language-css .token.string,.kqpsvw .style .token.string{color:#9a6e3a;}/*!sc*/
.kqpsvw .token.atrule,.kqpsvw .token.attr-value,.kqpsvw .token.keyword{color:#07a;}/*!sc*/
.kqpsvw .token.function,.kqpsvw .token.class-name{color:#dd4a68;}/*!sc*/
.kqpsvw .token.regex,.kqpsvw .token.important,.kqpsvw .token.variable{color:#e90;}/*!sc*/
.kqpsvw .token.important,.kqpsvw .token.bold{font-weight:bold;}/*!sc*/
.kqpsvw .token.italic{font-style:italic;}/*!sc*/
.kqpsvw .token.entity{cursor:help;}/*!sc*/
data-styled.g770[id="sc-2n8uaj-4"]{content:"kqpsvw,"}/*!sc*/
.gyWqNe{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;padding:0 1.5rem;}/*!sc*/
data-styled.g778[id="sc-1tx9li6-0"]{content:"gyWqNe,"}/*!sc*/
.hQuWQW{font-size:0.75rem;margin-bottom:0.5rem;text-transform:uppercase;}/*!sc*/
data-styled.g779[id="sc-1tx9li6-1"]{content:"hQuWQW,"}/*!sc*/
.dhvtXR{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;line-height:normal;}/*!sc*/
data-styled.g781[id="sc-1sugbjn-0"]{content:"dhvtXR,"}/*!sc*/
</style><div class="sc-1sugbjn-1 jnaMkA"><div class="sc-1sugbjn-2 hMQlEz"><h3 id="step-3-of-5" class="sc-1sugbjn-3 iylRCG"></h3><div><div class="sc-z3f5s1-0 jOOFPV" data-test="blocks"><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-0"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">Next, we define the possible hidden states (characters, firstnames, and surnames) and their transition probabilities. We also define the emission probabilities (the probability of generating a particular output character given a hidden state) as a 27x27 matrix for characters and a 6x27 matrix for firstnames/surnames (5 firstnames + 7 surnames = 12 possible hidden states).</div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">characters <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcdefghijklmnopqrstuvwxyz'</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">firstnames <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'davidantonfredjimbarry'</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">surnames <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'barberilsungfoxchainfitzwilliamquinceadamsgrafvonunterhosen'</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="5" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="6" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">char_probs <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.7</span> <span class="token operator">/</span> <span class="token number">26</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="7" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="8" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    char_probs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.3</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="9" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="10" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">name_probs <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.7</span> <span class="token operator">/</span> <span class="token number">26</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="11" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="12" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    name_probs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.2</span> <span class="token operator">/</span> <span class="token number">26</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="13" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    name_probs<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.2</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="14" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="15" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    name_probs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.2</span> <span class="token operator">/</span> <span class="token number">26</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="16" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    name_probs<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0.2</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="17" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-2"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1tx9li6-0 gyWqNe" data-test="block-3"><div class="sc-1tx9li6-1 hQuWQW">Explanation</div><div class="sc-1swtczx-0 fjTYVF" data-test="block-3-text-block"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">The Viterbi algorithm proceeds in two steps:</div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div><div class="sc-1aslxm9-2 csrprK">Initialization: We compute the scores (log-probabilities) of starting in each state and emitting the first character of the observed sequence. These scores are stored in the first row of the <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">scores</code></strong> matrix.</div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div><div class="sc-1aslxm9-2 csrprK">Recursion: For each time step <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i</code></strong> and each state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">j</code></strong>, we compute the score of being in state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">j</code></strong> and emitting the character at time <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i</code></strong>. This score is the sum of three terms: (i) the score of being in the previous state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">k</code></strong> and transitioning to state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">j</code></strong>, (ii) the score of emitting the character at time <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i</code></strong> given state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">j</code></strong>, and (iii) the score of emitting the prefix of the observed sequence up to time <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i-1</code></strong> given state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">k</code></strong>. We take the maximum of these scores over all possible previous states <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">k</code></strong> to compute the score and backpointer (i.e., the index of the previous state that achieved that score) for state <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">j</code></strong> at time <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">i</code></strong>. These scores and backpointers are stored in the <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">scores</code></strong> and <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">backpointers</code></strong> matrices, respectively.</div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-4"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div></div>- - - - - - - - - - - - - - - - - - - - - - - - <style data-styled="true" data-styled-version="5.3.6">.jOOFPV{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/*!sc*/
data-styled.g713[id="sc-z3f5s1-0"]{content:"jOOFPV,"}/*!sc*/
.drpmfd{white-space:pre-wrap;}/*!sc*/
data-styled.g715[id="sc-1aslxm9-0"]{content:"drpmfd,"}/*!sc*/
.csrprK{text-align:start;}/*!sc*/
data-styled.g717[id="sc-1aslxm9-2"]{content:"csrprK,"}/*!sc*/
.hSgzqy{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g744[id="sc-9wsboo-0"]{content:"hSgzqy,"}/*!sc*/
.fjTYVF{margin:0;font-size:1rem;}/*!sc*/
data-styled.g746[id="sc-1swtczx-0"]{content:"fjTYVF,"}/*!sc*/
.fiTshW{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;font-size:0.75rem;box-sizing:border-box;}/*!sc*/
data-styled.g766[id="sc-2n8uaj-0"]{content:"fiTshW,"}/*!sc*/
.cEHddw{position:relative;}/*!sc*/
data-styled.g767[id="sc-2n8uaj-1"]{content:"cEHddw,"}/*!sc*/
.eWUOMm::before{position:absolute;content:attr(data-line);color:rgba(60,60,60,0.5);top:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}/*!sc*/
data-styled.g768[id="sc-2n8uaj-2"]{content:"eWUOMm,"}/*!sc*/
.dNhINZ{margin-left:2em;}/*!sc*/
data-styled.g769[id="sc-2n8uaj-3"]{content:"dNhINZ,"}/*!sc*/
.kqpsvw{background-color:#f7f7f7;}/*!sc*/
.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
.kqpsvw pre[class*='language-']::selection,.kqpsvw pre[class*='language-']::selection,.kqpsvw code[class*='language-']::selection,.kqpsvw code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
@media print{.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{text-shadow:none;}}/*!sc*/
.kqpsvw pre[class*='language-']{padding:1em;margin:0.5em 0;overflow:auto;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-'],.kqpsvw pre[class*='language-']{background:#f5f2f0;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-']{padding:0.1em;border-radius:0.3em;white-space:normal;}/*!sc*/
.kqpsvw div,.kqpsvw span,.kqpsvw .token{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
.kqpsvw .token.comment,.kqpsvw .token.prolog,.kqpsvw .token.doctype,.kqpsvw .token.cdata{color:slategray;}/*!sc*/
.kqpsvw .token.punctuation{color:#999;}/*!sc*/
.kqpsvw .token.namespace{opacity:0.7;}/*!sc*/
.kqpsvw .token.property,.kqpsvw .token.tag,.kqpsvw .token.boolean,.kqpsvw .token.number,.kqpsvw .token.constant,.kqpsvw .token.symbol,.kqpsvw .token.deleted{color:#905;}/*!sc*/
.kqpsvw .token.selector,.kqpsvw .token.attr-name,.kqpsvw .token.string,.kqpsvw .token.char,.kqpsvw .token.builtin,.kqpsvw .token.inserted{color:#690;}/*!sc*/
.kqpsvw .token.operator,.kqpsvw .token.entity,.kqpsvw .token.url,.kqpsvw .language-css .token.string,.kqpsvw .style .token.string{color:#9a6e3a;}/*!sc*/
.kqpsvw .token.atrule,.kqpsvw .token.attr-value,.kqpsvw .token.keyword{color:#07a;}/*!sc*/
.kqpsvw .token.function,.kqpsvw .token.class-name{color:#dd4a68;}/*!sc*/
.kqpsvw .token.regex,.kqpsvw .token.important,.kqpsvw .token.variable{color:#e90;}/*!sc*/
.kqpsvw .token.important,.kqpsvw .token.bold{font-weight:bold;}/*!sc*/
.kqpsvw .token.italic{font-style:italic;}/*!sc*/
.kqpsvw .token.entity{cursor:help;}/*!sc*/
data-styled.g770[id="sc-2n8uaj-4"]{content:"kqpsvw,"}/*!sc*/
.gyWqNe{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;padding:0 1.5rem;}/*!sc*/
data-styled.g778[id="sc-1tx9li6-0"]{content:"gyWqNe,"}/*!sc*/
.hQuWQW{font-size:0.75rem;margin-bottom:0.5rem;text-transform:uppercase;}/*!sc*/
data-styled.g779[id="sc-1tx9li6-1"]{content:"hQuWQW,"}/*!sc*/
.dhvtXR{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;line-height:normal;}/*!sc*/
data-styled.g781[id="sc-1sugbjn-0"]{content:"dhvtXR,"}/*!sc*/
</style><div class="sc-1sugbjn-1 jnaMkA"><div class="sc-1sugbjn-2 hMQlEz"><h3 id="step-4-of-5" class="sc-1sugbjn-3 iylRCG"></h3><div><div class="sc-z3f5s1-0 jOOFPV" data-test="blocks"><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-0"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">The <strong class="sc-1r1de4b-0 gHXJCW">path</strong> variable contains the most likely sequence of hidden states. We use it to construct the intended clean sequence by alternating between firstnames and surnames as dictated by the state transitions.</div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1tx9li6-0 gyWqNe" data-test="block-1"><div class="sc-1tx9li6-1 hQuWQW">Explanation</div><div class="sc-1swtczx-0 fjTYVF" data-test="block-1-text-block"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">After computing the <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">scores</code></strong> and <strong class="sc-1r1de4b-0 gHXJCW"><code class="sc-1r1de4b-5 hSywLr">backpointers</code></strong> matrices, we use them to trace back the most likely path (i.e., sequence of states) that generated the observed sequence. We start at the last time step and follow the backpointers backwards to the first time step. This gives us the sequence of states that maximizes the probability of generating the observed sequence.</div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-2"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token comment"># Trace back the most likely path</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">path <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">path<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="5" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="6" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    path<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> backpointers<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="7" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="8" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">clean_sequence <span class="token operator">=</span> <span class="token string">''</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="9" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="10" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    <span class="token keyword">if</span> path<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="11" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        clean_sequence <span class="token operator">+=</span> firstnames<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> noisy_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="12" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    <span class="token keyword">else</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="13" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        clean_sequence <span class="token operator">+=</span> surnames<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> noisy_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="14" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="15" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">print</span><span class="token punctuation">(</span>clean_sequence<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="16" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="17" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-4"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1tx9li6-0 gyWqNe" data-test="block-5"><div class="sc-1tx9li6-1 hQuWQW">Explanation</div><div class="sc-1swtczx-0 fjTYVF" data-test="block-5-text-block"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">Next, we use the sequence of states to construct the intended clean sequence by alternating between firstnames and surnames as dictated by the state transitions. We also append the observed character at each time step to the clean sequence.</div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-6"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div></div>- - - - - - - - - - - - - - - - - - - - - - - - <style data-styled="true" data-styled-version="5.3.6">.jOOFPV{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/*!sc*/
data-styled.g713[id="sc-z3f5s1-0"]{content:"jOOFPV,"}/*!sc*/
.drpmfd{white-space:pre-wrap;}/*!sc*/
data-styled.g715[id="sc-1aslxm9-0"]{content:"drpmfd,"}/*!sc*/
.csrprK{text-align:start;}/*!sc*/
data-styled.g717[id="sc-1aslxm9-2"]{content:"csrprK,"}/*!sc*/
.hSgzqy{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;}/*!sc*/
data-styled.g744[id="sc-9wsboo-0"]{content:"hSgzqy,"}/*!sc*/
.fjTYVF{margin:0;font-size:1rem;}/*!sc*/
data-styled.g746[id="sc-1swtczx-0"]{content:"fjTYVF,"}/*!sc*/
.fiTshW{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;font-size:0.75rem;box-sizing:border-box;}/*!sc*/
data-styled.g766[id="sc-2n8uaj-0"]{content:"fiTshW,"}/*!sc*/
.cEHddw{position:relative;}/*!sc*/
data-styled.g767[id="sc-2n8uaj-1"]{content:"cEHddw,"}/*!sc*/
.eWUOMm::before{position:absolute;content:attr(data-line);color:rgba(60,60,60,0.5);top:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;}/*!sc*/
data-styled.g768[id="sc-2n8uaj-2"]{content:"eWUOMm,"}/*!sc*/
.dNhINZ{margin-left:2em;}/*!sc*/
data-styled.g769[id="sc-2n8uaj-3"]{content:"dNhINZ,"}/*!sc*/
.kqpsvw{background-color:#f7f7f7;}/*!sc*/
.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{color:black;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}/*!sc*/
.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw pre[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection,.kqpsvw code[class*='language-']::-moz-selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
.kqpsvw pre[class*='language-']::selection,.kqpsvw pre[class*='language-']::selection,.kqpsvw code[class*='language-']::selection,.kqpsvw code[class*='language-']::selection{text-shadow:none;background:#b3d4fc;}/*!sc*/
@media print{.kqpsvw code[class*='language-'],.kqpsvw pre[class*='language-']{text-shadow:none;}}/*!sc*/
.kqpsvw pre[class*='language-']{padding:1em;margin:0.5em 0;overflow:auto;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-'],.kqpsvw pre[class*='language-']{background:#f5f2f0;}/*!sc*/
.kqpsvw:not(pre) > code[class*='language-']{padding:0.1em;border-radius:0.3em;white-space:normal;}/*!sc*/
.kqpsvw div,.kqpsvw span,.kqpsvw .token{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
.kqpsvw .token.comment,.kqpsvw .token.prolog,.kqpsvw .token.doctype,.kqpsvw .token.cdata{color:slategray;}/*!sc*/
.kqpsvw .token.punctuation{color:#999;}/*!sc*/
.kqpsvw .token.namespace{opacity:0.7;}/*!sc*/
.kqpsvw .token.property,.kqpsvw .token.tag,.kqpsvw .token.boolean,.kqpsvw .token.number,.kqpsvw .token.constant,.kqpsvw .token.symbol,.kqpsvw .token.deleted{color:#905;}/*!sc*/
.kqpsvw .token.selector,.kqpsvw .token.attr-name,.kqpsvw .token.string,.kqpsvw .token.char,.kqpsvw .token.builtin,.kqpsvw .token.inserted{color:#690;}/*!sc*/
.kqpsvw .token.operator,.kqpsvw .token.entity,.kqpsvw .token.url,.kqpsvw .language-css .token.string,.kqpsvw .style .token.string{color:#9a6e3a;}/*!sc*/
.kqpsvw .token.atrule,.kqpsvw .token.attr-value,.kqpsvw .token.keyword{color:#07a;}/*!sc*/
.kqpsvw .token.function,.kqpsvw .token.class-name{color:#dd4a68;}/*!sc*/
.kqpsvw .token.regex,.kqpsvw .token.important,.kqpsvw .token.variable{color:#e90;}/*!sc*/
.kqpsvw .token.important,.kqpsvw .token.bold{font-weight:bold;}/*!sc*/
.kqpsvw .token.italic{font-style:italic;}/*!sc*/
.kqpsvw .token.entity{cursor:help;}/*!sc*/
data-styled.g770[id="sc-2n8uaj-4"]{content:"kqpsvw,"}/*!sc*/
.gyWqNe{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;padding:0 1.5rem;}/*!sc*/
data-styled.g778[id="sc-1tx9li6-0"]{content:"gyWqNe,"}/*!sc*/
.hQuWQW{font-size:0.75rem;margin-bottom:0.5rem;text-transform:uppercase;}/*!sc*/
data-styled.g779[id="sc-1tx9li6-1"]{content:"hQuWQW,"}/*!sc*/
.dhvtXR{margin:0;font-family:"Aspira Webfont","Helvetica","Arial",sans-serif;line-height:normal;}/*!sc*/
data-styled.g781[id="sc-1sugbjn-0"]{content:"dhvtXR,"}/*!sc*/
</style><div class="sc-1sugbjn-1 jnaMkA"><div class="sc-1sugbjn-2 hMQlEz"><h3 id="step-5-of-5" class="sc-1sugbjn-3 iylRCG"></h3><div><div class="sc-z3f5s1-0 jOOFPV" data-test="blocks"><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-0"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">
Finally, we construct the matrix of (firstname, surname) counts by scanning through the clean sequence and counting occurrences.</div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1tx9li6-0 gyWqNe" data-test="block-1"><div class="sc-1tx9li6-1 hQuWQW">Explanation</div><div class="sc-1swtczx-0 fjTYVF" data-test="block-1-text-block"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK">we scan through the clean sequence and count the occurrences of (firstname, surname) pairs. We do this by looking at pairs of adjacent states that correspond to a firstname and surname, respectively, and incrementing the corresponding entry in the <strong class="sc-1r1de4b-0 gHXJCW">m</strong> matrix. This matrix represents the count of occurrences of each (firstname, surname) pair.</div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-2"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-2n8uaj-0 fiTshW"><div class="sc-2n8uaj-4 kqpsvw"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-2n8uaj-1 cEHddw"><div data-line="1" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="2" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">m <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="3" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="4" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">    <span class="token keyword">if</span> path<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">:</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="5" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        firstname_idx <span class="token operator">=</span> path<span class="token punctuation">[</span>i<span class="token punctuation">]</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="6" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        surname_idx <span class="token operator">=</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">5</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="7" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK">        m<span class="token punctuation">[</span>firstname_idx<span class="token punctuation">,</span> surname_idx<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="8" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></div></div></div><div class="sc-2n8uaj-1 cEHddw"><div data-line="9" role="presentation" aria-hidden="true" class="sc-2n8uaj-2 eWUOMm"></div><div class="sc-2n8uaj-3 dNhINZ"><div class="sc-1aslxm9-2 csrprK"><br class="sc-1aslxm9-1 jlKJbt"></div></div></div></div></div></div></div></div><div class="sc-z3f5s1-1 cnliOm"><div class="sc-1swtczx-0 fjTYVF" data-test="block-4"><div class="sc-9wsboo-0 hSgzqy"><div class="sc-1aslxm9-0 drpmfd"><div class="sc-1aslxm9-2 csrprK"><strong class="sc-1r1de4b-0 gHXJCW">This should output the desired matrix of counts.</strong></div></div></div></div></div></div></div></div></div>                                                </div>

                                            </div>
                                        </div>
                                    </li></ul></div>



                            </div>








                        </div>

                    </div>



                </div>
            </div>
        </div>
        <div class="chg-global-screen-blocker"></div>
    </div>

</div>





</body></html>